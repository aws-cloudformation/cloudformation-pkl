/// AWS::IoT::SecurityProfile
///
/// Generated by rain build --pkl-class AWS::IoT::SecurityProfile
module aws.iot.securityprofile

import "../../cloudformation.pkl"

/// A structure containing the alert target ARN and the role ARN.
open class SecurityProfileAlertTarget {
    AlertTargetArn: String|Mapping
    RoleArn: String|Mapping
}

/// A security profile behavior.
open class SecurityProfileBehavior {
    Criteria: (SecurityProfileBehaviorCriteria)?
    ExportMetric: (SecurityProfileExportMetric)?
    Metric: (String(matches(Regex(#"[a-zA-Z0-9:_-]+"#)))|Mapping)?
    MetricDimension: (SecurityProfileMetricDimension)?
    Name: String(matches(Regex(#"[a-zA-Z0-9:_-]+"#)))|Mapping
    SuppressAlerts: (Boolean|Mapping)?
}

typealias BehaviorCriteriaComparisonOperator = "less-than"|"less-than-equals"|"greater-than"|"greater-than-equals"|"in-cidr-set"|"not-in-cidr-set"|"in-port-set"|"not-in-port-set"|"in-set"|"not-in-set"

/// The criteria by which the behavior is determined to be normal.
open class SecurityProfileBehaviorCriteria {
    ComparisonOperator: (BehaviorCriteriaComparisonOperator|Mapping)?
    ConsecutiveDatapointsToAlarm: (Int|Mapping)?
    ConsecutiveDatapointsToClear: (Int|Mapping)?
    DurationSeconds: (Int|Mapping)?
    MlDetectionConfig: (SecurityProfileMachineLearningDetectionConfig)?
    StatisticalThreshold: (SecurityProfileStatisticalThreshold)?
    Value: (SecurityProfileMetricValue)?
}

typealias SecurityProfileExportMetric = Boolean|Mapping


typealias MachineLearningDetectionConfigConfidenceLevel = "LOW"|"MEDIUM"|"HIGH"

/// The configuration of an ML Detect Security Profile.
open class SecurityProfileMachineLearningDetectionConfig {
    ConfidenceLevel: (MachineLearningDetectionConfigConfidenceLevel|Mapping)?
}

typealias MetricDimensionOperator = "IN"|"NOT_IN"

/// The dimension of a metric.
open class SecurityProfileMetricDimension {
    DimensionName: String(matches(Regex(#"[a-zA-Z0-9:_-]+"#)))|Mapping
    Operator: (MetricDimensionOperator|Mapping)?
}

/// The metric you want to retain. Dimensions are optional.
open class SecurityProfileMetricToRetain {
    ExportMetric: (SecurityProfileExportMetric)?
    Metric: String(matches(Regex(#"[a-zA-Z0-9:_-]+"#)))|Mapping
    MetricDimension: (SecurityProfileMetricDimension)?
}

/// The value to be compared with the metric.
open class SecurityProfileMetricValue {
    Cidrs: (Listing<String|Mapping>)?
    Count: (String|Mapping)?
    Number: (Number|Mapping)?
    Numbers: (Listing<Number|Mapping>)?
    Ports: (Listing<Int|Mapping>)?
    Strings: (Listing<String|Mapping>)?
}

typealias StatisticalThresholdStatistic = "Average"|"p0"|"p0.1"|"p0.01"|"p1"|"p10"|"p50"|"p90"|"p99"|"p99.9"|"p99.99"|"p100"

/// A statistical ranking (percentile) which indicates a threshold value by which a behavior is determined to be in compliance or in violation of the behavior.
open class SecurityProfileStatisticalThreshold {
    Statistic: (StatisticalThresholdStatistic|Mapping)?
}

/// A key-value pair to associate with a resource.
open class SecurityProfileTag {
    Key: String|Mapping
    Value: String|Mapping
}

/// A security profile defines a set of expected behaviors for devices in your account.
open class SecurityProfile extends cloudformation.Resource {

    Type = "AWS::IoT::SecurityProfile"


    /// A list of metrics whose data is retained (stored). By default, data is retained for any metric used in the profile's behaviors, but it is also retained for any metric specified here.
    hidden AdditionalMetricsToRetainV2: (Listing<SecurityProfileMetricToRetain>)?

    /// Specifies the destinations to which alerts are sent.
    hidden AlertTargets: (SecurityProfileSecurityProfileAlertTargets)?

    /// Specifies the behaviors that, when violated by a device (thing), cause an alert.
    hidden Behaviors: (Listing<SecurityProfileBehavior>)?

    /// A structure containing the mqtt topic for metrics export.
    hidden MetricsExportConfig: (Dynamic)?

    /// A description of the security profile.
    hidden SecurityProfileDescription: (String|Mapping)?

    /// A unique identifier for the security profile.
    hidden SecurityProfileName: (String(matches(Regex(#"[a-zA-Z0-9:_-]+"#)))|Mapping)?

    /// Metadata that can be used to manage the security profile.
    hidden Tags: (Listing<SecurityProfileTag>)?

    /// A set of target ARNs that the security profile is attached to.
    hidden TargetArns: (Listing<String|Mapping>)?

    Properties {
        ["AdditionalMetricsToRetainV2"] = if (AdditionalMetricsToRetainV2 == null) null else AdditionalMetricsToRetainV2
        ["AlertTargets"] = if (AlertTargets == null) null else AlertTargets
        ["Behaviors"] = if (Behaviors == null) null else Behaviors
        ["MetricsExportConfig"] = if (MetricsExportConfig == null) null else MetricsExportConfig
        ["SecurityProfileDescription"] = if (SecurityProfileDescription == null) null else SecurityProfileDescription
        ["SecurityProfileName"] = if (SecurityProfileName == null) null else SecurityProfileName
        ["Tags"] = if (Tags == null) null else Tags
        ["TargetArns"] = if (TargetArns == null) null else TargetArns
    }

}


typealias SecurityProfileSecurityProfileAlertTargets = Mapping<String, Any>
