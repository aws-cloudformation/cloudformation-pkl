/// AWS::GreengrassV2::Deployment
///
/// Generated by rain build --pkl-class AWS::GreengrassV2::Deployment
module aws.greengrassv2.deployment

import "../../cloudformation.pkl"

/// 
open class DeploymentComponentConfigurationUpdate {
    Merge: (String|Mapping)?
    Reset: (Listing<String|Mapping>)?
}

/// 
open class DeploymentComponentDeploymentSpecification {
    ComponentVersion: (String|Mapping)?
    ConfigurationUpdate: (DeploymentComponentConfigurationUpdate)?
    RunWith: (DeploymentComponentRunWith)?
}

/// 
open class DeploymentComponentRunWith {
    PosixUser: (String|Mapping)?
    SystemResourceLimits: (DeploymentSystemResourceLimits)?
    WindowsUser: (String|Mapping)?
}

typealias DeploymentComponentUpdatePolicyAction = "NOTIFY_COMPONENTS"|"SKIP_NOTIFY_COMPONENTS"

/// 
open class DeploymentDeploymentComponentUpdatePolicy {
    Action: (DeploymentComponentUpdatePolicyAction|Mapping)?
    TimeoutInSeconds: (Int|Mapping)?
}

/// 
open class DeploymentDeploymentConfigurationValidationPolicy {
    TimeoutInSeconds: (Int|Mapping)?
}

/// 
open class DeploymentDeploymentIoTJobConfiguration {
    AbortConfig: (DeploymentIoTJobAbortConfig)?
    JobExecutionsRolloutConfig: (DeploymentIoTJobExecutionsRolloutConfig)?
    TimeoutConfig: (DeploymentIoTJobTimeoutConfig)?
}

typealias DeploymentPoliciesFailureHandlingPolicy = "ROLLBACK"|"DO_NOTHING"

/// 
open class DeploymentDeploymentPolicies {
    ComponentUpdatePolicy: (DeploymentDeploymentComponentUpdatePolicy)?
    ConfigurationValidationPolicy: (DeploymentDeploymentConfigurationValidationPolicy)?
    FailureHandlingPolicy: (DeploymentPoliciesFailureHandlingPolicy|Mapping)?
}

/// 
open class DeploymentIoTJobAbortConfig {
    CriteriaList: Listing<DeploymentIoTJobAbortCriteria>
}

typealias IoTJobAbortCriteriaAction = "CANCEL"

typealias IoTJobAbortCriteriaFailureType = "FAILED"|"REJECTED"|"TIMED_OUT"|"ALL"

/// 
open class DeploymentIoTJobAbortCriteria {
    Action: IoTJobAbortCriteriaAction|Mapping
    FailureType: IoTJobAbortCriteriaFailureType|Mapping
    MinNumberOfExecutedThings: Int|Mapping
    ThresholdPercentage: Number|Mapping
}

/// 
open class DeploymentIoTJobExecutionsRolloutConfig {
    ExponentialRate: (DeploymentIoTJobExponentialRolloutRate)?
    MaximumPerMinute: (Int|Mapping)?
}

/// 
open class DeploymentIoTJobExponentialRolloutRate {
    BaseRatePerMinute: Int|Mapping
    IncrementFactor: Number|Mapping
    RateIncreaseCriteria: DeploymentIoTJobRateIncreaseCriteria
}

typealias DeploymentIoTJobRateIncreaseCriteria = Dynamic


/// 
open class DeploymentIoTJobTimeoutConfig {
    InProgressTimeoutInMinutes: (Int|Mapping)?
}

typealias DeploymentNumberOfThings = Int|Mapping


/// 
open class DeploymentSystemResourceLimits {
    Cpus: (Number|Mapping)?
    Memory: (Int|Mapping)?
}

/// Resource for Greengrass V2 deployment.
open class Deployment extends cloudformation.Resource {

    Type = "AWS::GreengrassV2::Deployment"


    /// 
    hidden Components: (DeploymentDeploymentComponents)?

    /// 
    hidden DeploymentName: (String|Mapping)?

    /// 
    hidden DeploymentPolicies: (DeploymentDeploymentPolicies)?

    /// 
    hidden IotJobConfiguration: (DeploymentDeploymentIoTJobConfiguration)?

    /// 
    hidden ParentTargetArn: (String(matches(Regex(#"arn:[^:]*:iot:[^:]*:[0-9]+:thinggroup/.+"#)))|Mapping)?

    /// 
    hidden Tags: (DeploymentDeploymentTags)?

    /// 
    hidden TargetArn: String(matches(Regex(#"arn:[^:]*:iot:[^:]*:[0-9]+:(thing|thinggroup)/.+"#)))|Mapping

    Properties {
        ["Components"] = if (Components == null) null else Components
        ["DeploymentName"] = if (DeploymentName == null) null else DeploymentName
        ["DeploymentPolicies"] = if (DeploymentPolicies == null) null else DeploymentPolicies
        ["IotJobConfiguration"] = if (IotJobConfiguration == null) null else IotJobConfiguration
        ["ParentTargetArn"] = if (ParentTargetArn == null) null else ParentTargetArn
        ["Tags"] = if (Tags == null) null else Tags
        ["TargetArn"] = if (TargetArn == null) null else TargetArn
    }

}


typealias DeploymentDeploymentComponents = Mapping<String, Any>

typealias DeploymentDeploymentTags = Mapping<String, Any>
