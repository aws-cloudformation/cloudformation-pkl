/// AWS::SageMaker::Cluster
///
/// Generated by rain build --pkl-class AWS::SageMaker::Cluster
module aws.sagemaker.cluster

import "../../cloudformation.pkl"

/// Defines the configuration for attaching additional Amazon Elastic Block Store (EBS) volumes to the instances in the SageMaker HyperPod cluster instance group. The additional EBS volume is attached to each instance within the SageMaker HyperPod cluster instance group and mounted to /opt/sagemaker.
open class ClusterClusterEbsVolumeConfig {
    VolumeSizeInGB: (Int|Mapping)?
}

/// Details of an instance group in a SageMaker HyperPod cluster.
open class ClusterClusterInstanceGroup {
    CurrentCount: (Int|Mapping)?
    ExecutionRole: ClusterExecutionRole
    InstanceCount: Int|Mapping
    InstanceGroupName: ClusterInstanceGroupName
    InstanceStorageConfigs: (ClusterClusterInstanceStorageConfigs)?
    InstanceType: ClusterInstanceType
    LifeCycleConfig: ClusterClusterLifeCycleConfig
    OnStartDeepHealthChecks: (ClusterOnStartDeepHealthChecks)?
    OverrideVpcConfig: (ClusterVpcConfig)?
    ThreadsPerCore: (Int|Mapping)?
}

typealias ClusterClusterInstanceGroupsList = Listing<(ClusterClusterInstanceGroup)?>


typealias ClusterClusterInstanceStorageConfig = Dynamic


typealias ClusterClusterInstanceStorageConfigs = Listing<(ClusterClusterInstanceStorageConfig)?>


/// The lifecycle configuration for a SageMaker HyperPod cluster.
open class ClusterClusterLifeCycleConfig {
    OnCreate: String(matches(Regex(#"^[\S\s]+$"#)))|Mapping
    SourceS3Uri: String(matches(Regex(#"^(https|s3)://([^/]+)/?(.*)$"#)))|Mapping
}

/// Specifies parameter(s) related to EKS as orchestrator, e.g. the EKS cluster nodes will attach to,
open class ClusterClusterOrchestratorEksConfig {
    ClusterArn: String|Mapping
}

typealias ClusterDeepHealthCheckType = String|Mapping


typealias ClusterExecutionRole = String|Mapping


typealias ClusterInstanceGroupName = String|Mapping


typealias ClusterInstanceType = String|Mapping


typealias ClusterOnStartDeepHealthChecks = Listing<(ClusterDeepHealthCheckType)?>


/// Specifies parameter(s) specific to the orchestrator, e.g. specify the EKS cluster.
open class ClusterOrchestrator {
    Eks: ClusterClusterOrchestratorEksConfig
}

/// A key-value pair to associate with a resource.
open class ClusterTag {
    Key: String(matches(Regex(#"^([\p{L}\p{Z}\p{N}_.:/=+\-@]*)$"#)))|Mapping
    Value: String(matches(Regex(#"^([\p{L}\p{Z}\p{N}_.:/=+\-@]*)$"#)))|Mapping
}

/// Specifies an Amazon Virtual Private Cloud (VPC) that your SageMaker jobs, hosted models, and compute resources have access to. You can control access to and from your resources by configuring a VPC.
open class ClusterVpcConfig {
    SecurityGroupIds: Listing<String|Mapping>
    Subnets: Listing<String|Mapping>
}

/// Resource Type definition for AWS::SageMaker::Cluster
open class Cluster extends cloudformation.Resource {

    Type = "AWS::SageMaker::Cluster"


    /// The name of the HyperPod Cluster.
    hidden ClusterName: (String(matches(Regex(#"^[a-zA-Z0-9](-*[a-zA-Z0-9]){0,62}$"#)))|Mapping)?

    /// 
    hidden InstanceGroups: ClusterClusterInstanceGroupsList

    /// If node auto-recovery is set to true, faulty nodes will be replaced or rebooted when a failure is detected. If set to false, nodes will be labelled when a fault is detected.
    hidden NodeRecovery: (ClusterNodeRecovery|Mapping)?

    /// 
    hidden Orchestrator: (ClusterOrchestrator)?

    /// Custom tags for managing the SageMaker HyperPod cluster as an AWS resource. You can add tags to your cluster in the same way you add them in other AWS services that support tagging.
    hidden Tags: (Listing<ClusterTag>)?

    /// 
    hidden VpcConfig: (ClusterVpcConfig)?

    Properties {
        ["ClusterName"] = if (ClusterName == null) null else ClusterName
        ["InstanceGroups"] = if (InstanceGroups == null) null else InstanceGroups
        ["NodeRecovery"] = if (NodeRecovery == null) null else NodeRecovery
        ["Orchestrator"] = if (Orchestrator == null) null else Orchestrator
        ["Tags"] = if (Tags == null) null else Tags
        ["VpcConfig"] = if (VpcConfig == null) null else VpcConfig
    }

}


typealias ClusterNodeRecovery = "Automatic"|"None"
