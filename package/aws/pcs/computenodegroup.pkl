/// AWS::PCS::ComputeNodeGroup
///
/// Generated by rain build --pkl-class AWS::PCS::ComputeNodeGroup
module aws.pcs.computenodegroup

import "../../cloudformation.pkl"

/// An error that occurred during resource provisioning.
open class ComputeNodeGroupErrorInfo {
    Code: (String|Mapping)?
    Message: (String|Mapping)?
}

/// An EC2 instance configuration AWS PCS uses to launch compute nodes.
open class ComputeNodeGroupInstanceConfig {
    InstanceType: (String|Mapping)?
}

/// Additional settings that directly map to Slurm settings.
open class ComputeNodeGroupSlurmCustomSetting {
    ParameterName: String|Mapping
    ParameterValue: String|Mapping
}

typealias ComputeNodeGroupSubnetId = String|Mapping


/// AWS::PCS::ComputeNodeGroup resource creates an AWS PCS compute node group.
open class ComputeNodeGroup extends cloudformation.Resource {

    Type = "AWS::PCS::ComputeNodeGroup"


    /// The ID of the Amazon Machine Image (AMI) that AWS PCS uses to launch instances. If not provided, AWS PCS uses the AMI ID specified in the custom launch template.
    hidden AmiId: (String(matches(Regex(#"^ami-[a-z0-9]+$"#)))|Mapping)?

    /// The ID of the cluster of the compute node group.
    hidden ClusterId: String|Mapping

    /// An Amazon EC2 launch template AWS PCS uses to launch compute nodes.
    hidden CustomLaunchTemplate: Dynamic

    /// The Amazon Resource Name (ARN) of the IAM instance profile used to pass an IAM role when launching EC2 instances. The role contained in your instance profile must have pcs:RegisterComputeNodeGroupInstance permissions attached to provision instances correctly.
    hidden IamInstanceProfileArn: String(matches(Regex(#"^arn:aws([a-zA-Z-]{0,10})?:iam::[0-9]{12}:instance-profile/.{1,128}$"#)))|Mapping

    /// A list of EC2 instance configurations that AWS PCS can provision in the compute node group.
    hidden InstanceConfigs: Listing<ComputeNodeGroupInstanceConfig>

    /// The name that identifies the compute node group.
    hidden Name: (String(matches(Regex(#"^(?!pcs_)^(?![A-Za-z0-9]{10}$)[A-Za-z][A-Za-z0-9-]+$"#)))|Mapping)?

    /// Specifies how EC2 instances are purchased on your behalf. AWS PCS supports On-Demand and Spot instances. For more information, see Instance purchasing options in the Amazon Elastic Compute Cloud User Guide. If you don't provide this option, it defaults to On-Demand.
    hidden PurchaseOption: (ComputeNodeGroupPurchaseOption|Mapping)?

    /// Specifies the boundaries of the compute node group auto scaling.
    hidden ScalingConfiguration: Dynamic

    /// Additional options related to the Slurm scheduler.
    hidden SlurmConfiguration: (Dynamic)?

    /// Additional configuration when you specify SPOT as the purchase option.
    hidden SpotOptions: (Dynamic)?

    /// The list of subnet IDs where instances are provisioned by the compute node group. The subnets must be in the same VPC as the cluster.
    hidden SubnetIds: Listing<ComputeNodeGroupSubnetId>

    /// 1 or more tags added to the resource. Each tag consists of a tag key and tag value. The tag value is optional and can be an empty string.
    hidden Tags: (ComputeNodeGroupComputeNodeGroupTags)?

    Properties {
        ["AmiId"] = if (AmiId == null) null else AmiId
        ["ClusterId"] = if (ClusterId == null) null else ClusterId
        ["CustomLaunchTemplate"] = if (CustomLaunchTemplate == null) null else CustomLaunchTemplate
        ["IamInstanceProfileArn"] = if (IamInstanceProfileArn == null) null else IamInstanceProfileArn
        ["InstanceConfigs"] = if (InstanceConfigs == null) null else InstanceConfigs
        ["Name"] = if (Name == null) null else Name
        ["PurchaseOption"] = if (PurchaseOption == null) null else PurchaseOption
        ["ScalingConfiguration"] = if (ScalingConfiguration == null) null else ScalingConfiguration
        ["SlurmConfiguration"] = if (SlurmConfiguration == null) null else SlurmConfiguration
        ["SpotOptions"] = if (SpotOptions == null) null else SpotOptions
        ["SubnetIds"] = if (SubnetIds == null) null else SubnetIds
        ["Tags"] = if (Tags == null) null else Tags
    }

}


typealias ComputeNodeGroupPurchaseOption = "ONDEMAND"|"SPOT"

typealias ComputeNodeGroupComputeNodeGroupTags = Mapping<String, Any>
