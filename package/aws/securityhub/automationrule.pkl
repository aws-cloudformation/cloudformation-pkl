/// AWS::SecurityHub::AutomationRule
///
/// Generated by rain build --pkl-class AWS::SecurityHub::AutomationRule
module aws.securityhub.automationrule

import "../../cloudformation.pkl"

typealias AutomationRulesActionType = "FINDING_FIELDS_UPDATE"

/// One or more actions that ASHlong takes when a finding matches the defined criteria of a rule.
open class AutomationRuleAutomationRulesAction {
    FindingFieldsUpdate: AutomationRuleAutomationRulesFindingFieldsUpdate
    Type: AutomationRulesActionType|Mapping
}

typealias AutomationRulesFindingFieldsUpdateVerificationState = "UNKNOWN"|"TRUE_POSITIVE"|"FALSE_POSITIVE"|"BENIGN_POSITIVE"

/// Identifies the finding fields that the automation rule action updates when a finding matches the defined criteria.
open class AutomationRuleAutomationRulesFindingFieldsUpdate {
    Confidence: (AutomationRuleint100)?
    Criticality: (AutomationRuleint100)?
    Note: (Dynamic)?
    RelatedFindings: (Listing<AutomationRuleRelatedFinding>)?
    Severity: (Dynamic)?
    Types: (Listing<String|Mapping>)?
    UserDefinedFields: (AutomationRulemap)?
    VerificationState: (AutomationRulesFindingFieldsUpdateVerificationState|Mapping)?
    Workflow: (Dynamic)?
}

/// The criteria that determine which findings a rule applies to.
open class AutomationRuleAutomationRulesFindingFilters {
    AwsAccountId: (Listing<AutomationRuleStringFilter>)?
    CompanyName: (Listing<AutomationRuleStringFilter>)?
    ComplianceAssociatedStandardsId: (Listing<AutomationRuleStringFilter>)?
    ComplianceSecurityControlId: (Listing<AutomationRuleStringFilter>)?
    ComplianceStatus: (Listing<AutomationRuleStringFilter>)?
    Confidence: (Listing<AutomationRuleNumberFilter>)?
    CreatedAt: (Listing<AutomationRuleDateFilter>)?
    Criticality: (Listing<AutomationRuleNumberFilter>)?
    Description: (Listing<AutomationRuleStringFilter>)?
    FirstObservedAt: (Listing<AutomationRuleDateFilter>)?
    GeneratorId: (Listing<AutomationRuleStringFilter>)?
    Id: (Listing<AutomationRuleStringFilter>)?
    LastObservedAt: (Listing<AutomationRuleDateFilter>)?
    NoteText: (Listing<AutomationRuleStringFilter>)?
    NoteUpdatedAt: (Listing<AutomationRuleDateFilter>)?
    NoteUpdatedBy: (Listing<AutomationRuleStringFilter>)?
    ProductArn: (Listing<AutomationRuleStringFilter>)?
    ProductName: (Listing<AutomationRuleStringFilter>)?
    RecordState: (Listing<AutomationRuleStringFilter>)?
    RelatedFindingsId: (Listing<AutomationRuleStringFilter>)?
    RelatedFindingsProductArn: (Listing<AutomationRuleStringFilter>)?
    ResourceDetailsOther: (Listing<AutomationRuleMapFilter>)?
    ResourceId: (Listing<AutomationRuleStringFilter>)?
    ResourcePartition: (Listing<AutomationRuleStringFilter>)?
    ResourceRegion: (Listing<AutomationRuleStringFilter>)?
    ResourceTags: (Listing<AutomationRuleMapFilter>)?
    ResourceType: (Listing<AutomationRuleStringFilter>)?
    SeverityLabel: (Listing<AutomationRuleStringFilter>)?
    SourceUrl: (Listing<AutomationRuleStringFilter>)?
    Title: (Listing<AutomationRuleStringFilter>)?
    Type: (Listing<AutomationRuleStringFilter>)?
    UpdatedAt: (Listing<AutomationRuleDateFilter>)?
    UserDefinedFields: (Listing<AutomationRuleMapFilter>)?
    VerificationState: (Listing<AutomationRuleStringFilter>)?
    WorkflowStatus: (Listing<AutomationRuleStringFilter>)?
}

/// 
open class AutomationRuleBooleanFilter {
    Value: Boolean|Mapping
}

/// A date filter for querying findings.
open class AutomationRuleDateFilter {
    DateRange: (AutomationRuleDateRange)?
    End: (AutomationRuleISO8601DateString)?
    Start: (AutomationRuleISO8601DateString)?
}

typealias DateRangeUnit = "DAYS"

/// A date range for the date filter.
open class AutomationRuleDateRange {
    Unit: DateRangeUnit|Mapping
    Value: Number|Mapping
}

typealias AutomationRuleISO8601DateString = String|Mapping


typealias MapFilterComparison = "EQUALS"|"NOT_EQUALS"|"CONTAINS"|"NOT_CONTAINS"

/// A map filter for filtering ASHlong findings. Each map filter provides the field to check for, the value to check for, and the comparison operator.
open class AutomationRuleMapFilter {
    Comparison: MapFilterComparison|Mapping
    Key: String|Mapping
    Value: String|Mapping
}

typealias AutomationRuleNonEmptyString = String|Mapping


/// The updated note.
open class AutomationRuleNoteUpdate {
    Text: String|Mapping
    UpdatedBy: AutomationRulearnOrId
}

/// A number filter for querying findings.
open class AutomationRuleNumberFilter {
    Eq: (Number|Mapping)?
    Gte: (Number|Mapping)?
    Lte: (Number|Mapping)?
}

/// Provides details about a list of findings that the current finding relates to.
open class AutomationRuleRelatedFinding {
    Id: AutomationRulearnOrId
    ProductArn: AutomationRulearn
}

typealias SeverityUpdateLabel = "INFORMATIONAL"|"LOW"|"MEDIUM"|"HIGH"|"CRITICAL"

/// Updates to the severity information for a finding.
open class AutomationRuleSeverityUpdate {
    Label: (SeverityUpdateLabel|Mapping)?
    Normalized: (AutomationRuleint100)?
    Product: (Number|Mapping)?
}

/// A string filter for filtering ASHlong findings.
open class AutomationRuleStringFilter {
    Comparison: AutomationRuleStringFilterComparison
    Value: String|Mapping
}

typealias AutomationRuleStringFilterComparison = String|Mapping


typealias AutomationRuleTags = Mapping<String, Any>


typealias WorkflowUpdateStatus = "NEW"|"NOTIFIED"|"RESOLVED"|"SUPPRESSED"

/// Used to update information about the investigation into the finding.
open class AutomationRuleWorkflowUpdate {
    Status: WorkflowUpdateStatus|Mapping
}

typealias AutomationRulearn = String|Mapping


typealias AutomationRulearnOrId = AutomationRulearnOrId0|AutomationRulearnOrId1


typealias AutomationRulearnOrId0 = String|Mapping


typealias AutomationRulearnOrId1 = AutomationRulearn


typealias AutomationRuleint100 = Int|Mapping


typealias AutomationRulemap = Mapping<String, Any>


typealias AutomationRuletimestamp = String|Mapping


/// The ``AWS::SecurityHub::AutomationRule`` resource specifies an automation rule based on input parameters. For more information, see [Automation rules](https://docs.aws.amazon.com/securityhub/latest/userguide/automation-rules.html) in the *User Guide*.
open class AutomationRule extends cloudformation.Resource {

    Type = "AWS::SecurityHub::AutomationRule"


    /// One or more actions to update finding fields if a finding matches the conditions specified in ``Criteria``.
    hidden Actions: Listing<AutomationRuleAutomationRulesAction>

    /// A set of [Security Finding Format (ASFF)](https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-findings-format.html) finding field attributes and corresponding expected values that ASH uses to filter findings. If a rule is enabled and a finding matches the criteria specified in this parameter, ASH applies the rule action to the finding.
    hidden Criteria: AutomationRuleAutomationRulesFindingFilters

    /// A description of the rule.
    hidden Description: String|Mapping

    /// Specifies whether a rule is the last to be applied with respect to a finding that matches the rule criteria. This is useful when a finding matches the criteria for multiple rules, and each rule has different actions. If a rule is terminal, Security Hub applies the rule action to a finding that matches the rule criteria and doesn't evaluate other rules for the finding. By default, a rule isn't terminal.
    hidden IsTerminal: (Boolean|Mapping)?

    /// The name of the rule.
    hidden RuleName: String|Mapping

    /// An integer ranging from 1 to 1000 that represents the order in which the rule action is applied to findings. Security Hub applies rules with lower values for this parameter first.
    hidden RuleOrder: Int|Mapping

    /// Whether the rule is active after it is created. If this parameter is equal to ``ENABLED``, ASH applies the rule to findings and finding updates after the rule is created.
    hidden RuleStatus: (AutomationRuleRuleStatus|Mapping)?

    /// User-defined tags associated with an automation rule.
    hidden Tags: (AutomationRuleTags)?

    Properties {
        ["Actions"] = if (Actions == null) null else Actions
        ["Criteria"] = if (Criteria == null) null else Criteria
        ["Description"] = if (Description == null) null else Description
        ["IsTerminal"] = if (IsTerminal == null) null else IsTerminal
        ["RuleName"] = if (RuleName == null) null else RuleName
        ["RuleOrder"] = if (RuleOrder == null) null else RuleOrder
        ["RuleStatus"] = if (RuleStatus == null) null else RuleStatus
        ["Tags"] = if (Tags == null) null else Tags
    }

}


typealias AutomationRuleRuleStatus = "ENABLED"|"DISABLED"
